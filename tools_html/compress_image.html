<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片压缩转换工具</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/compress_image.css">
</head>

<body>
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="../js/menu.js"></script>
    <script src="../third_part/tga-decoder.js"></script>
    <script src="../third_part/bmp-encoder.js"></script>
    <script src="../third_part/tga-encoder.js"></script>
    <script src="../third_part/dds-encoder.js"></script>
    <script src="../js/compress_image.js" defer></script>
    <div id="main_bg"></div>
    <div class="left_menu">
        <ul class="menu_root">
            <li class="left_item">
                <div class="left_icon" id="left_icon1"></div>
                <div class="item_context">AI工具箱</div>
                <ul class="sub_menu">
                    <li><a href="chatgpt.html">ChatGPT</a></li>
                    <li><a href="ai_upscale.html">AI高清放大</a></li>
                    <li><a href="ai_frame_interpolation.html">AI插帧/分辨率</a></li>
                    <li><a href="ai_draw.html">AI绘画</a></li>
                </ul>
            </li>
            <li class="left_item">
                <div class="left_icon" id="left_icon1"></div>
                <div class="item_context">3D工具/图片处理</div>
                <ul class="sub_menu">
                    <li><a href="compress_image.html">图片压缩转换</a></li>
                    <li><a href="3d_city.html">3D城市地形筑下载</a></li>
                    <li><a href="combine_rgba.html">贴图通道合成</a></li>
                    <li><a href="hdr_editor.html">HDR编辑器</a></li>
                    <li><a href="ps_online.html">在线PS</a></li>
                    <li><a href="pbr_texture_generator.html">PBR贴图生成器</a></li>
                <li><a href="model_previewer.html">模型预览器</a></li>
                </ul>
            </li>
            <li class="left_item">
                <div class="left_icon" id="left_icon1"></div>
                <div class="item_context">视频处理</div>
                <ul class="sub_menu">
                    <li><a href="video_cut.html">视频剪辑</a></li>
                    <li><a href="video_format_cover.html">视频格式转换</a></li>
                </ul>
            </li>
            <li class="left_item">
                <div class="left_icon" id="left_icon1"></div>
                <div class="item_context">TA工具</div>
                <ul class="sub_menu">
                    <li><a href="shader_library.html">shader函数库</a></li>
                    <li><a href="ue_material_picture.html">UE材质库</a></li>
                    <li><a href="physics_light.html">物理光照计算器</a></li>
                    <li><a href="TA_wiki.html">TA知识库</a></li>
                </ul>
            </li>
            <li class="left_item">
                <div class="left_icon" id="left_icon1"></div>
                <div class="item_context">和我一起听</div>
                <ul class="sub_menu">
                    <li><a href="cloud_music.html">网易云音乐</a></li>
                </ul>
            </li>
            <li class="left_item">关于

            </li>
        </ul>
    </div>
    <div class="top_search">
        <input type="text" placeholder="搜索">
    </div>
    <div id="panel">
        <h1>图片压缩转换工具</h1>

        <input type="file" id="fileInput" multiple accept="image/*,.tga,.dds,.bmp" hidden>
        <input type="file" id="folderInput" webkitdirectory directory multiple hidden>

        <div class="workbench-layout">
            <div class="queue-column">
                <div class="column-title">处理队列</div>
                <div class="file-list" id="fileList"></div>
            </div>

            <div class="control-column">
                <div class="upload-section">
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-content">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            <p>拖拽图片到此处或点击选择</p>
                            <p class="sub-text">支持 JPG, PNG, WEBP, GIF, BMP, TGA, DDS；也支持 Ctrl+V 粘贴图片</p>
                        </div>
                    </div>
                    <button type="button" id="selectFolderUpload" class="upload-folder-btn">选择文件夹上传</button>
                </div>

                <div class="settings-panel">
                    <div class="setting-group">
                        <label>输出格式</label>
                        <select id="outputFormat">
                            <option value="keep">保持原格式</option>
                            <option value="jpeg">JPEG</option>
                            <option value="png">PNG</option>
                            <option value="webp" selected>WebP</option>
                            <option value="bmp">BMP</option>
                            <option value="tga">TGA</option>
                            <option value="dds">DDS</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label>压缩质量 <span id="qualityValue">80</span>%</label>
                        <input type="range" id="quality" min="1" max="100" value="80">
                    </div>

                    <div class="setting-group">
                        <label>体积控制</label>
                        <div class="radio-group">
                            <label><input type="radio" name="sizeControlMode" value="quality" checked> 按压缩质量</label>
                            <label><input type="radio" name="sizeControlMode" value="target"> 压缩到目标体积以内</label>
                        </div>
                        <div class="target-size-row">
                            <input type="number" id="targetSizeMb" min="0.05" step="0.05" value="1.00" disabled>
                            <span>MB / 每张</span>
                        </div>
                        <div class="setting-hint">说明：目标模式会尽量压到不超过目标体积（<= 目标值）。</div>
                    </div>

                    <div class="setting-group">
                        <label>输出方式</label>
                        <div class="radio-group">
                            <label><input type="radio" name="outputMode" value="download" checked> 下载到浏览器</label>
                            <label><input type="radio" name="outputMode" value="zip"> 下载为ZIP</label>
                            <label><input type="radio" name="outputMode" value="folder"> 输出到文件夹 <span style="font-size: 11px; color: #888;">(需Chrome/Edge)</span></label>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label>文件命名</label>
                        <div class="radio-group">
                            <label><input type="radio" name="namingMode" value="original" checked> 保持原文件名</label>
                            <label class="suffix-option">
                                <input type="radio" name="namingMode" value="suffix"> 添加后缀
                                <input type="text" id="namingSuffix" value="_compressed" class="suffix-input">
                            </label>
                        </div>
                    </div>

                    <div class="setting-group" id="folderPathGroup" style="display: none;">
                        <label>输出文件夹</label>
                        <div class="folder-input">
                            <input type="text" id="folderPath" placeholder="选择输出文件夹" readonly>
                            <button id="selectFolderBtn">选择文件夹</button>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button id="clearBtn" class="btn-secondary">清空列表</button>
                    <button id="processBtn" class="btn-primary">开始处理</button>
                </div>

                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">处理中... 0/0</div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>
